# 1 计算机网络概述

## 什么是网络

网络是一个连接了物体、设备、人的复杂系统、

相较于电信网/电视网，计算机网络共享的资源由终端计算机处理，可以共享多种资源 

## Data Networks Classifications 数据网络分类

### LAN(Local Area Networks)

* 一般通过广播方式通讯

- 本地运作 (覆盖区域小)
- 多用户通道
- 高速率需求 (高达10Gbps)
- 错误率可以轻松控制

### WAN(Wide Area Networks)

* 一般通过点对点方式通信

- 在大范围运作
- 通过串行链路、光链路连接
- 通常速度慢
- 错误率不好控制

### 局域网设备

hub 在第一层将设备连接起来 多端口中继器

bridge 网桥 基于MAC地址将局域网分段 第二层

switch 多端口网桥 全带宽 第二层

router 路由器 ip地址划分进行路径选择 报文转发 第三层

### 广域网设备

router 路径选择 报文转发

modem 调制解调器 CSU通道服务单元/DSU数据服务单元 模拟转为数字 远程LAN链接 

### 局域网服务和广域网服务

LAN：以太网，最受欢迎

WAN：种类多

### Internet

商业化后 用户通过ISP(Internet service provider)接入Internet 

ISP层次不同 

主机A->本地ISP->第二层ISP->NAP->第一层ISP->NAP->第二层ISP->本地ISP->主机B

![image-20210524102100993](C:\Users\Edward\AppData\Roaming\Typora\typora-user-images\image-20210524102100993.png)

## Data

数据通过01序列传输，但不是01本身，需要解码

### Data Packets

为了使传输双方理解数据，规范传输标准，对不同的传输层次设置不同的数据格式

OSI参考模型中：网络层-packets 数据链路层-frames 数据段层-segments

好处：

计算机系统为分时操作系统 分成报文可以同时处理多个

某个报文丢失，重新传输丢失的一小块即可，保证效率

每个报文可以独立传输，可以选择当前最优路径

### Protocol 协议

为传输计算机网络通讯进行保障 和终端操作系统无关 不同系统可以通过相同的协议进行通信

类似于语言 语法就是协议的数据结构 语用/俗语 相当于协议中的上下文处理关系 

数据传输规则 报文中内容可以不同

### Source and Destination 源和目的

很多时候 通讯都是随机的 通讯时一般都是弱联系 没有打好招呼

目的告诉传输者报文发送到哪里 源告诉传输者报文哪里来的 多用于重新传输

### Media Types 传输介质

电：同轴电缆 粗缆 细缆 双绞线 UTP-非屏蔽双绞线 

光：光缆 速率快 不像电流 更加稳定

空气：无限传输 无需介质

### Digital Bandwidth 带宽

传输能力的度量-传输上限

单位bps bits为传输单位 传输时将字节转为位再计算带宽

### Throughput 通量

通量为实际网络传输量 因此 通量<=带宽

## Open System Interconnection Model OSI参考模型

 开放性系统互连参考标准

从一个发送点到达另一个终端  分层后 每个层次进行特定的任务

OSI把网络分为7层

1. 物理层 Physical：二进制传输

   keywords：信号&介质

   定义了传输介质，传输规格：信号等级/传输速率/信号规格 

   不做管理和控制

2. 数据链路层 Data Link：介质访问

   keywords：帧&MAC 介质访问控制

   基于帧的格式判断传输的数据是否正确并做相应的控制

   如果服务于多个用户，还要管理介质访问，避免冲突

3. 网络层 Networks：路径选择

   keywords：路径选择，基于ip地址设备联通

   跨距离远 地理上分隔开的连接

4. 传输层 Transport：终端与终端的通讯

   keywords：可靠性，流控制，错误修改

   网络系统同时收到不同报文 要发送给不同终端

   把数据分成段 并且转为数据流 传输完判断 确定数据正确再传给上层

5. 会话层 Session：进程间通讯时用户的交流

   keywords：会话

   在双方通讯时设置checkpoint确认双方是否同步以及进程控制

6. 表示层 Presentation：通讯时表示格式标准

   keywords ：Common Format 

   数据格式

7. 应用层 Application：给用户交互接口

   keywords： Browser 用户界面

好处：减少网络复杂程度/更标准化/根据层次确定产品定位 实现网络工程化 

Application Layers 应用层次：5/6/7

用户程序涉及的部分

Data Flow Layers 数据流层：1/2/3/4

网络通讯由这四层负责

OSI分层中的协议

 ![image-20210524112215333](C:\Users\Edward\AppData\Roaming\Typora\typora-user-images\image-20210524112215333.png)

### Data Encapsulation 数据封装

 ![image-20210524112539119](C:\Users\Edward\AppData\Roaming\Typora\typora-user-images\image-20210524112539119.png)

### Peer to Peer Communications

 ![image-20210524115216395](C:\Users\Edward\AppData\Roaming\Typora\typora-user-images\image-20210524115216395.png)

## TCP/IP Model 参考模型

TCP/IP只有4层

 ![image-20210524115322525](C:\Users\Edward\AppData\Roaming\Typora\typora-user-images\image-20210524115322525.png)

应用层对应OSI 5/6/7三层 对应软件相关事宜：界面处理、标准化等

传输层对应OSI 4 实现数据传输 详见OSI-4

Internet Layer 对应OSI-3 负责联通、连接和传输报文 并不要求可靠性

Network Access Layer 网络接入层 也叫 host-to-network Layer 对应OSI-1&2 

### TCP/IP 相关协议

 ![image-20210524193111141](C:\Users\Edward\AppData\Roaming\Typora\typora-user-images\image-20210524193111141.png)

向上能兼容应用，向下能兼容介质

*FTP* - File Transfer Protocol 文件传输协议

*HTTP* -  Hypertext Transfer Protocol 超文本传输协议

*SMTP* - Simple Mail Transfer protocol 简单邮件传输协议 (主要对应发送

*DNS* - Domain Name System 域名解析系统

*TFTP* - Trivial File Transfer Protocol 简单文件传输协议

## Network Topology 网络拓扑

定义了网络的结构

物理层面：把node具体的连接起来--介质的具体分布

逻辑层面：定义了介质的访问控制--介质如何被host访问

### Bus 总线型

 ![image-20210524194142311](C:\Users\Edward\AppData\Roaming\Typora\typora-user-images\image-20210524194142311.png)

每个host都共享总线

物理层面：

​	优点：连接方便，成本低

​	缺点：总线出现折损，整个线路都无法使用

逻辑层面：

​	每个节点都能获取总线信号，如果多个节点同时向总线发送信号则会出现冲突

### Ring 环形

 ![image-20210524194536452](C:\Users\Edward\AppData\Roaming\Typora\typora-user-images\image-20210524194536452.png)

物理层面：

​	所有设备都直接通过环彼此相连 -- daisy-chain

逻辑层面：

​	为了避免冲突，不允许同时使用 -- 令牌环 拿到令牌有一个时间窗口来访问介质

### Dual Ring 双环

有两个环同时接入，也需要令牌，内环只是备用，当外环损坏就切换到内环

物理层面：

​	更可靠可行

逻辑层面：

​	双环类似两个独立的环，但这两个环同一时间只使用一个

### Star 星形

 ![image-20210524195143403](C:\Users\Edward\AppData\Roaming\Typora\typora-user-images\image-20210524195143403.png)



有一个中间节点将其他节点连接起来

物理层面：

​	优点：所有其他节点通讯都可以通过中心节点转发，无需经过其他节点，使得通讯更加安全

​	缺点：中心节点负担大，性能需要加强，如果中心节点瘫痪则无法使用

逻辑层面：

​	所有信息的流都会经过中心节点

### Tree 树/层次结构

越往下视野越小，适用于有逻辑层次划分的节点

物理层面：

​	树干（trunk）是拥有多层分支的线

逻辑层面：

​	信息流是分层的

### Complete/Mesh 渔网形

物理层面：	

​	任意两节点都相连

​	优点：最大的连通性和可靠性

​	缺点：花费大

逻辑层面：

​	拓扑的性能极依赖于所使用的设备

Cellular 蜂窝形

物理层面：

​	蜂窝拓扑使用与无线网络技术，一般来说比较低效，需要相当的算法设计

## Network Devices

设备可以分为两大类

* 边缘节点 -- 终端设备：主机、打印机等

  一般工作层次比较复杂，功能齐全

* 中间节点 -- 中间设备：路由器、交换机等

### NICs Net Interface Controller 网卡 

第二层的设备

每个网卡都有一个MAC地址，是固定的

串行并行转换

 ![image-20210524213010037](C:\Users\Edward\AppData\Roaming\Typora\typora-user-images\image-20210524213010037.png)

终端设备和中间设备都需要网卡

### Media 介质

Layer 1 电信号/光信号进行传输

### Repeater 中继器

Layer 1 连接两个端口 信号的识别放大 延长介质

### Hub 集线器

Layer 1 连接多个端口 Multiple Repeater

逻辑上使用总线方式连接

### Bridges 网桥

Layer 2 可做流量过滤 根据设备的MAC地址将网段分为两个分段(冲突域) 根据MAC地址形成MAC table

根据目的地址判断是否需要转发到别的段 比hub智能一些

### Switches 交换机

负责帧的识别和转发 

交换机的每个端口和网桥一样 因此交换机可以将网络分为很多冲突域

物理星形，逻辑星形 (hub是物理星形逻辑总线)

### Router 路由器

检查报文并转发

局域网通过路由器相连形成广域网 因此路由器要在广域网上找到合适的目的进行报文转发

 ![image-20210524214258564](C:\Users\Edward\AppData\Roaming\Typora\typora-user-images\image-20210524214258564.png)

高层设备可以识别低层的数据格式路由器能识别帧 交换机可以接入介质

低层设备无法识别高层设备

# OSI层次

## Physical 物理层

### Network Type 网络类型

通讯分为两种：多路复用&点对点

共享介质：主要通过电信号传播——不止是同轴电缆，现在基于hub和双绞线也可以实现

点对点：主要基于光缆，早期的拨号方式也是

### LAN Media 物理层介质

电信号/光信号/无线电波——功能都是传输数据

其转发过程都被成为encoding 编码

通过调幅调频来实现编码

*STP* - Shielded Twisted Pair 屏蔽双绞线

#### UTP 非屏蔽双绞线

*UTP* - Unshielded Twisted Pair 非屏蔽双绞线

两股线绞在一起，一定程度上避免电磁波干扰，相较于STP更便宜，有效范围100m

优点：易于部署/轻便，便宜

缺点：只通过双绞避免噪音，避免噪音能力不强，需要原理大功率电器、范围有限

#### Coaxial 同轴电缆

比较早的传输介质

橡胶套->绝缘膜->金属网->塑胶套 分为细缆(便宜，传输距离小)粗缆(贵，传输距离长，一般500m)

#### Fiber-Optic 光缆

一般两个接口，一个发送，一个接收，成本高

单模：

细，传输损耗小，传输距离远，一般广域网使用

多模：

粗，传输损耗大，可以同时传输多路信号，一般局域网使用

#### Wireless 无线

Lasers 激光 

Infrared

Radio

### UTP for Ethernet 

一类线：主要用于语音传输，不用于数据传输

二类线：传输频率1MHz，用于语音和最高4Mbps的数据传输，常见于令牌网 

三类线：EIA/TIA568标准指定电缆，传输频率16MHz，用于语音传输及最高传输速率为10Mbps的数据传输，主要用于10BASE-T 

四类线：传输频率为20MHz，用于语音传输和最高传输速率16Mbps的数据传输，主要用于令牌网和 10BASE-T/100BASE-T 

五类线：增加了绕线密度，外套高质量绝缘材料，用于语音和数据传输(主要为100/1000BASE-T)，是最常用的以太网电缆 

超五类线：衰减小，串扰少，具有更高的衰减/串扰比和信噪比、更小的时延误差，主要用于1000BASE-T

六类线：传输频率为1MHz～250MHz，性能远高于超五类标准，适用于高于1Gbps的应用

七类线：带宽为600MHz，可能用于今后的10G比特以太网。 

### 网线分类

#### 直通线（straight cable）：

线的两端都是T568A或T568B

作用：主机连到交换机/交换机连到路由器

#### 反转线（console cable 控制台线）：

一端的插脚1连接另一端的插脚8；然后插脚2连接到插脚7、插脚3连接到插脚6，以此类推

用于把PC连接到交换机或者路由器 连接PC时还要加一个转接口并启用超级终端

#### 交叉线（Crossover）：

一端是T568A，另一端是T568B

可用于连接两个相同的设备，PC与路由器直连，也可用于连接两个或多个集线器或交换机

连接两个独立的工作站以创建迷你局域网

### Media and Signal Problems

Propagation 传播 -- 传播时间：由介质决定

Attenuation 衰减 -- 信号介质和周围干扰都会产生损耗

Noise 干扰

### Collision Domains冲突域

第一层不能解决冲突问题，需要对第一层进行一定的限制，在第二第三层分段